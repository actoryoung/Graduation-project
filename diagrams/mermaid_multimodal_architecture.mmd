flowchart TD
    %% å®šä¹‰æ ·å¼
    classDef textNode fill:#E3F2FD,stroke:#1976D2,stroke-width:3px
    classDef audioNode fill:#E8F5E9,stroke:#43A047,stroke-width:3px
    classDef videoNode fill:#FFEBEE,stroke:#E53935,stroke-width:3px
    classDef opNode fill:#E1F5FE,stroke:#0277BD,stroke-width:2px
    classDef fusionNode fill:#F3E5F5,stroke:#7B1FA2,stroke-width:3px
    classDef classNode fill:#FFF3E0,stroke:#FF9800,stroke-width:3px

    %% ===== è¾“å…¥å±‚ =====
    subgraph Input["è¾“å…¥å±‚"]
        TInput["æ–‡æœ¬è¾“å…¥ Text<br/>768ç»´"]:::textNode
        AInput["éŸ³é¢‘è¾“å…¥ Audio<br/>74ç»´"]:::audioNode
        VInput["è§†é¢‘è¾“å…¥ Video<br/>710ç»´"]:::videoNode
    end

    %% ===== ç‰¹å¾ç¼–ç å±‚ =====
    subgraph Encoder["ç‰¹å¾ç¼–ç å±‚"]
        TEnc["æ–‡æœ¬ç¼–ç å™¨<br/>Linear(768â†’256)<br/>LayerNorm + ReLU"]:::opNode
        AEnc["éŸ³é¢‘ç¼–ç å™¨<br/>Linear(74â†’128)<br/>LayerNorm + ReLU"]:::opNode
        VEnc["è§†é¢‘ç¼–ç å™¨<br/>Linear(710â†’256)<br/>LayerNorm + ReLU"]:::opNode
        AProj["éŸ³é¢‘æŠ•å½±å±‚<br/>Linear(128â†’256)"]:::opNode
    end

    %% ===== è·¨æ¨¡æ€èåˆå±‚ =====
    subgraph Fusion["è·¨æ¨¡æ€èåˆå±‚"]
        PosEnc["ä½ç½®ç¼–ç <br/>Positional Encoding"]:::fusionNode
        TransFusion["Transformerèåˆ<br/>Multi-Head Attention<br/>4å¤´ Ã— 2å±‚"]:::fusionNode
        FusionAgg["èšåˆä¸èåˆ<br/>Mean Pooling<br/>+ MLP"]:::fusionNode
    end

    %% ===== è¾“å‡ºå±‚ =====
    subgraph Output["è¾“å‡ºå±‚"]
        Classifier["åˆ†ç±»å™¨<br/>Linear(128â†’7)"]:::classNode
        Result["æƒ…æ„Ÿé¢„æµ‹<br/>7ç±» + ç½®ä¿¡åº¦"]:::classNode
    end

    %% ===== è¿æ¥å…³ç³» =====
    TInput -->|"768D"| TEnc
    AInput -->|"74D"| AEnc
    VInput -->|"710D"| VEnc

    AEnc -->|"128D"| AProj

    TEnc -->|"256D"| PosEnc
    AProj -->|"256D"| PosEnc
    VEnc -->|"256D"| PosEnc

    PosEnc -->|"3Ã—256D"| TransFusion
    TransFusion -->|"256D"| FusionAgg
    FusionAgg -->|"128D"| Classifier
    Classifier -->|"7ç±»"| Result

    %% ===== å›¾ä¾‹ =====
    subgraph Legend["å›¾ä¾‹"]
        LText["ğŸ“ æ–‡æœ¬æ¨¡æ€"]:::textNode
        LAudio["ğŸµ éŸ³é¢‘æ¨¡æ€"]:::audioNode
        LVideo["ğŸ¬ è§†é¢‘æ¨¡æ€"]:::videoNode
    end

    %% æ ·å¼è°ƒæ•´
    style Input fill:#f8f9fa,stroke:#dee2e6,stroke-width:2px,stroke-dasharray: 5 5
    style Encoder fill:#f8f9fa,stroke:#dee2e6,stroke-width:2px,stroke-dasharray: 5 5
    style Fusion fill:#f8f9fa,stroke:#dee2e6,stroke-width:2px,stroke-dasharray: 5 5
    style Output fill:#f8f9fa,stroke:#dee2e6,stroke-width:2px,stroke-dasharray: 5 5
