# 多模态情感分析项目 - 主文档

**文档用途**: 项目架构跟踪、任务进度管理、论文核心要点
**更新时间**: 2026-02-06 (v3.6 - 论文结构指南 + S7集成Web应用)
**状态**: 实验完成，论文撰写阶段

---

## 📑 快速导航 <a name="快速导航"></a>

### 核心查询

| 需求 | 跳转位置 |
|------|---------|
| 最终推荐模型 | [决策记录](#决策记录) |
| 所有模型性能 | [性能总览](#性能总览) |
| 待完成任务 | [进度跟踪](#进度跟踪) |
| 论文核心亮点 | [论文亮点](#论文亮点) |
| 实验详细报告 | [详细报告链接](#详细报告链接) |

### 最终模型

- **主要配置**: S7-v1 (59.47%测试准确率)
- **平衡配置**: Config C (31.17% Negative准确率)

---

## 论文核心亮点 <a name="论文亮点"></a>

### 1. 数据集诚实分析 ⭐⭐⭐⭐⭐
- SDK子集仅2,249样本（论文报告22,834，约1:10）
- 标签分布差异：50.4%中性情感（论文报告26.1%）
- 官方离散化规则已验证

### 2. 预训练模型局限 ⭐⭐⭐⭐⭐
- BERT在小规模不平衡数据上表现不如GloVe
- GloVe: 53.11%测试准确率
- BERT混合: 50.44%测试准确率

### 3. 标签正确性影响
- 错误标签导致虚假高准确率（69.97% → 59.33%）
- 数据验证流程可作为论文亮点

### 4. 真实性能水平
- 50-60%准确率反映任务真实难度
- 中性情感占50.4%，基线50.4%准确率

---

## 论文关键数据 <a name="论文数据"></a>

### 数据集规模对比

| 项目 | SDK子集 | 完整数据集 | 比例 |
|------|---------|-----------|------|
| 训练集 | 2,249 | 22,834 | ~1:10 |
| 验证集 | 300 | 2,787 | ~1:10 |
| 测试集 | 678 | 6,870 | ~1:10 |
| **总计** | **3,227** | **32,491** | **~1:10** |

### 标签分布对比

| 类别 | SDK子集 | 论文报告 |
|------|---------|---------|
| Neutral | **50.4%** | 26.1% |
| Negative | 10.0% | 30.2% |
| Positive | 39.6% | 43.7% |

### 基线模型详细配置

```
特征维度: GloVe(300) + COVAREP(74) + OpenFace(710) = 1084维
融合维度: 256
模型参数: 250,823
批次大小: 32
学习率: 0.001
训练轮数: 30
GPU: RTX 4060
```

### 手工特征 vs 预训练特征

| 模态 | 手工特征 | 预训练特征 | 维度提升 |
|------|---------|-----------|---------|
| 文本 | GloVe (300) | BERT (768) | 2.6x |
| 音频 | COVAREP (74) | wav2vec (768) | 10.4x |
| 视频 | OpenFace (710) | ResNet (2048) | 2.9x |

### 数据清洗效果

| 实验 | 数据清洗 | 归一化 | 测试准确率 | 提升 |
|------|---------|--------|-----------|------|
| Exp0 | ❌ | ❌ | 49.56% | - |
| Exp1 | ✅ | ✅ | 53.11% | +3.55% |

---

## 执行原则 <a name="执行原则"></a>

### 原则0: 任务确认机制
**用户提问后不要急着完成任务，除非明确给出开始的命令**
- 用户提问可能是咨询、探索、确认意图
- 需要等待明确的"开始"、"执行"、"好的"等命令才行动
- 避免过度主动，给用户保留控制权

### 原则1: 驳斥机制
用户明确要求可以驳斥其观点，提供客观技术建议

### 原则2: 脚本管理
避免创建过多脚本文件，优先修改现有脚本

### 原则3: 论文写作专家模式 ⭐⭐⭐
**论文撰写时必须使用多模态情感分析论文写作专家模式**
- 专家配置文件: `.claude/agents/multimodal_sentiment_writer_prompt.md`
- 核心能力: 多模态学习、情感计算、顶会论文风格
- 写作规范:
  * 学术诚信：禁止抄袭、诚实报告实验条件
  * 多模态研究规范：明确数据集划分、警惕数据泄露
  * 术语一致性：使用标准多模态术语
- 论文结构: Abstract → Introduction → Related Work → Methodology → Experiments → Discussion → Conclusion
- 必须包含: 架构图、消融实验、混淆矩阵、显著性检验

**分层递进写作流程**:
1. 大纲构建 ✅
2. 章节概述 (每章3-5段核心内容)
3. 分段扩充 (展开细节、数据、图表)
4. 润色完善 (过渡、引用、格式)

---

## 改进方案总览 <a name="改进方案"></a>

| ID | 方案 | 优先级 | 状态 | 结果 |
|----|------|--------|------|------|
| S1 | 3类简化 | ⭐⭐⭐⭐⭐ | ✅ | +4.43% |
| S2 | Focal Loss | ⭐⭐⭐⭐⭐ | ❌ | 效果不佳 |
| S3 | 注意力融合 | ⭐⭐⭐⭐ | ✅ | +1.63% |
| S4 | 类别权重 | ⭐⭐⭐⭐ | ✅ | 解决0%问题 |
| S5 | Transformer | ⭐⭐⭐ | ❌ | 过拟合 |
| S7 | 集成学习 | ⭐⭐⭐ | ✅ | +0.30% |
| S10 | Macro F1优化 | ⭐⭐⭐⭐ | ✅ | +21.3% (F1) |

---

## 进度跟踪 <a name="进度跟踪"></a>

### 已完成工作

| 任务 | 结果 |
|------|------|
| 数据验证 | 100%一致 |
| 基线模型 | GloVe 53.11%, BERT 50.44% |
| 消融实验 | 3类CE最优 57.54% |
| S3注意力 | 59.17%测试，Negative 0% |
| S3+S4权重 | 56.80%测试，Negative 25.97% |
| S4策略优化 | linear最优 58.14% |
| S7集成学习 | 59.47%测试，23.38% Negative |
| S7-v3平衡 | Config C: 31.17% Negative |
| **S10 Macro F1** | **Macro F1: 0.5011** (+21.3%) ⭐ |

### 待完成任务

**主要任务**: 论文撰写 ⭐

**可选任务** (论文加分项):
- 数据增强 (S6)
- 模型蒸馏 (S8)

---

## 决策记录 <a name="决策记录"></a>

| ID | 决策 | 日期 | 说明 |
|----|------|------|------|
| D1 | 使用SDK子集 | 02-05 | 数据已验证 |
| D2 | 论文核心论点 | 02-05 | 简单模型在不足数据上表现好 |
| D3 | 不使用S3单独 | 02-06 | Negative类失效 |
| D4 | S7-v1最终模型 | 02-06 | 59.47%准确率 |
| D5 | 双配置策略 | 02-06 | S7-v1 + Config C |
| D6 | **S10最优方案** | 02-09 | CE重训，Macro F1达0.5011 |

---

## 性能总览 <a name="性能总览"></a>

### 最终推荐模型

| 配置 | 测试准确率 | Negative准确率 | 适用场景 |
|------|-----------|---------------|----------|
| **S7-v1** | **59.47%** | 23.38% | 论文主要指标 ⭐ |
| **Config C** | 57.69% | **31.17%** | 类别平衡分析 ⭐ |

### 模型排名 TOP 6

| 排名 | 模型 | 测试准确率 |
|------|------|-----------|
| 1 | S7-v1集成 | 59.47% |
| 2 | S3单独 | 59.17% |
| 3 | Config C | 57.69% |
| 4 | S4-linear | 58.14% |
| 5 | 基线3类 | 57.54% |
| 6 | S4-sqrt | 56.80% |

**完整对比**: [详细报告链接](#详细报告链接)

---

## 详细报告链接 <a name="详细报告链接"></a>

### 核心实验报告

| 报告 | 内容 | 用途 |
|------|------|------|
| [实验历程完整记录](EXPERIMENT_JOURNEY.md) | 完整实验过程 + 项目原则 | ⭐⭐⭐ 论文实验章节 |
| [消融实验](ABLATION_EXPERIMENT_RESULTS.md) | S1-S5完整对比 | 消融实验详细 |
| [S7集成学习](S7_ENSEMBLE_RESULTS.md) | S7-v1详细结果 | 集成学习详细 |
| [S4权重策略](S4_WEIGHT_STRATEGY_EXPERIMENT_FINAL_REPORT.md) | linear/sqrt/square对比 | 权重策略详细 |
| [S7-v3平衡](S7_V3_BALANCE_EXPERIMENT.md) | 双配置详细对比 | 平衡优化详细 |
| **[S10 Macro F1优化](S10_MACRO_F1_FINAL_REPORT.md)** | **Macro F1从0.41→0.50** | **⭐⭐⭐ 类别平衡** |

### 项目管理记录

| 文档 | 内容 |
|------|------|
| [文件整理记录](CLEANUP_RECORD.md) | 临时文件清理记录 |

### 论文写作指南

| 文档 | 内容 | 用途 |
|------|------|------|
| [论文撰写素材集](THESIS_MATERIALS.md) | 图表/数据/表述汇总 ⭐⭐⭐ | 论文写作必备素材 |
| [论文结构指南](THESIS_STRUCTURE_GUIDE.md) | 完整章节结构 + 写作建议 | ⭐⭐⭐ 论文写作 |
| [S7 Web应用指南](web/S7_WEB_GUIDE.md) | S7集成版本使用说明 | ⭐⭐ 答辩演示 |

### 毕业设计资料

| 文档 | 内容 |
|------|------|
| README.md | 项目说明 |
| 文献综述.md | 论文文献综述 |
| 外文翻译.md | 外文翻译 |
| 参考文献.md | 参考文献 |
| [任务书优化分析](TASK_OPTIMIZATION_ANALYSIS.md) | 任务书要求对比 + 优化调整建议 ⭐ |

---

## 重要文件路径 <a name="文件路径"></a>

### 数据
- `data/mosei/processed_cleaned_correct/` - 正确训练数据

### 模型 (checkpoints/)
| 文件 | 说明 |
|------|------|
| `baseline_best_model.pth` | GloVe基线 (53.11%) |
| `baseline_attention_3class_ce_best_model.pth` | S3 (59.17%) |
| `baseline_attention_3class_weighted_best_model.pth` | S3+S4-sqrt (56.80%) |
| `baseline_attention_3class_weighted_linear_best_model.pth` | S4-linear (58.14%) |
| `baseline_attention_3class_weighted_square_best_model.pth` | S4-square (55.92%) |

### 脚本 (根目录)
- `config.py` - 项目配置
- `main.py` - 主入口
- `convert_to_3class.py` - 数据转换工具

### 脚本 (scripts/)
- `scripts/ensemble_predict.py` - S7集成预测脚本

### Web应用 (web/) ⭐ S7集成版本
- `web/app_s7.py` - S7-v1集成Web应用
- `web/ensemble_predictor.py` - S7集成预测模块
- `web/run_s7.bat` - 启动脚本

### 归档
- `scripts_archive/` - 已归档的分析/测试/验证脚本 (18个)
- `docs_archive/` - 已归档的过程文档 (13个)

---

## 论文结构建议 <a name="论文结构"></a>

### 标题
"在类别不平衡小规模数据上的多模态情感分析研究：预训练模型的局限性与改进策略"

### 章节安排
1. 引言
2. 相关工作
3. 数据集与分析（SDK子集特性）
4. 方法（基线 + 改进策略）
5. 实验（消融实验）
6. 结果与讨论（预训练模型局限性）
7. 结论

---

**文档维护**: 每次新决策/实验时更新对应章节
